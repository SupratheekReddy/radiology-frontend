<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Radiology Portal</title>

  <!-- SOCKET.IO -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

  <style>
    /* --------------- GLOBAL --------------- */
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
    }
    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1f2933 0, #050608 55%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #e5e7eb;
    }

    /* Login Card */
    .auth-card {
      width: 380px;
      max-width: 95vw;
      background: #0b1015;
      border-radius: 14px;
      border: 1px solid rgba(148,163,184,0.5);
      box-shadow: 0 24px 60px rgba(0,0,0,0.85);
      padding: 22px 24px 20px;
    }
    .auth-title { text-align:center;font-size:20px;font-weight:650;margin-bottom:4px; }
    .auth-subtitle { text-align:center;font-size:12px;color:#9ca3af;margin-bottom:18px; }

    .role-toggle { display:flex;background:#020617;border-radius:999px;padding:2px;border:1px solid #374151;margin-bottom:18px;}
    .role-btn { flex:1;padding:7px;font-size:12px;border-radius:999px;border:none;background:transparent;color:#9ca3af;cursor:pointer; }
    .role-btn.active { background:#111827;color:#fff;font-weight:600; }

    .auth-input {
      width:100%;padding:9px 10px;font-size:13px;background:#020617;
      border-radius:8px;border:1px solid #1f2937;color:#e5e7eb;margin-bottom:10px;
    }

    .primary-btn {
      width:100%;margin-top:6px;padding:9px;font-size:13px;border-radius:8px;
      background:linear-gradient(90deg,#2563eb,#38bdf8);color:white;font-weight:600;
      border:none;cursor:pointer;
    }

    .error-text { color:#f97373;font-size:12px;display:none;margin-top:6px; }

    /* Dashboard */
    .dashboard {
      display:none;width:min(1000px,96vw);background:#050a10;border-radius:12px;
      border:1px solid #4b5563;box-shadow:0 24px 70px rgba(0,0,0,0.9);
      padding:16px;color:#e5e7eb;
    }

    .tab-bar { display:flex;gap:6px;margin:10px 0;flex-wrap:wrap; }
    .tab-link { padding:5px 10px;border-radius:999px;font-size:11px;border:1px solid #4b5563;background:#020617;cursor:pointer; }
    .tab-link.active { background:#1d4ed8;border-color:#1d4ed8; }

    .section {
      display:none;background:#020617;border-radius:10px;border:1px solid #111827;
      padding:10px;margin-top:8px;
    }

    .section-title { font-size:12px;color:#93c5fd;margin-bottom:6px; }

    .case-list { list-style:none;margin-top:4px; }
    .case-card { background:#020617;border:1px solid #1f2937;border-radius:8px;padding:8px;margin-bottom:8px;font-size:12px; }

    .image-strip img {
      max-width:120px;max-height:90px;border-radius:4px;border:1px solid #1f2937;
    }

    .small-btn { padding:4px 8px;font-size:11px;border-radius:999px;border:1px solid #4b5563;background:transparent;color:white;cursor:pointer;margin-top:4px; }
  </style>
</head>

<body>

<!-- ----------------------------------------------------------- -->
<!-- LOGIN CARD -->
<!-- ----------------------------------------------------------- -->
<div class="auth-card" id="loginCard">
  <div class="auth-title">Radiology Portal</div>
  <div class="auth-subtitle">Login to your workspace</div>

  <div class="role-toggle" id="roleToggle">
    <button class="role-btn active" data-role="admin">Admin</button>
    <button class="role-btn" data-role="doctor">Doctor</button>
    <button class="role-btn" data-role="technician">Technician</button>
    <button class="role-btn" data-role="radiologist">Radiologist</button>
    <button class="role-btn" data-role="patient">Patient</button>
  </div>

  <input id="loginId" class="auth-input" placeholder="username" />
  <input id="loginPassword" class="auth-input" type="password" placeholder="password" />

  <button class="primary-btn" id="loginBtn">Sign in</button>
  <div class="error-text" id="loginError">Invalid credentials</div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- ADMIN DASHBOARD -->
<!-- ----------------------------------------------------------- -->
<div class="dashboard" id="adminDashboard">
  <div class="dash-header">
    <div><div class="dash-title">Admin Console</div></div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>

  <div class="tab-bar">
    <button class="tab-link active" data-target="adminAddDoctor">Add Doctor</button>
    <button class="tab-link" data-target="adminAddTech">Add Technician</button>
    <button class="tab-link" data-target="adminAddPatient">Add Patient</button>
    <button class="tab-link" data-target="adminSchedule">Schedule Case</button>
    <button class="tab-link" data-target="adminCases">All Cases</button>
  </div>

  <!-- Add Doctor -->
  <div class="section" id="adminAddDoctor">
    <div class="section-title">Add Doctor</div>
    <input id="docName" class="auth-input" placeholder="Name" />
    <input id="docEmail" class="auth-input" placeholder="Email" />
    <input id="docUser" class="auth-input" placeholder="Username" />
    <button class="primary-btn" onclick="addDoctor()">Save</button>
    <div class="success-text" id="docSuccess">Doctor added.</div>
  </div>

  <!-- Add Technician -->
  <div class="section" id="adminAddTech">
    <div class="section-title">Add Technician</div>
    <input id="techName" class="auth-input" placeholder="Name" />
    <input id="techEmail" class="auth-input" placeholder="Email" />
    <input id="techUser" class="auth-input" placeholder="Username" />
    <input id="techPass" class="auth-input" placeholder="Password" />
    <button class="primary-btn" onclick="addTechnician()">Save</button>
    <div class="success-text" id="techSuccess">Technician added.</div>
  </div>

  <!-- Add Patient -->
  <div class="section" id="adminAddPatient">
    <div class="section-title">Add Patient</div>
    <input id="patName" class="auth-input" placeholder="Name" />
    <input id="patEmail" class="auth-input" placeholder="Email" />
    <input id="patUser" class="auth-input" placeholder="Username" />
    <input id="patPass" class="auth-input" placeholder="Password" />
    <select id="patPriority" class="auth-input">
      <option value="Critical">Critical</option>
      <option value="Medium">Medium</option>
      <option value="Safe">Safe</option>
    </select>
    <button class="primary-btn" onclick="addPatient()">Save</button>
    <div class="success-text" id="patSuccess">Patient added.</div>
  </div>

  <!-- Schedule Case -->
  <div class="section" id="adminSchedule">
    <div class="section-title">Schedule Case</div>
    <select id="casePatient" class="auth-input"></select>
    <select id="caseDoctor" class="auth-input"></select>
    <input type="date" id="caseDate" class="auth-input" />
    <select id="caseSlot" class="auth-input">
      <option>09:00-10:00</option>
      <option>10:00-11:00</option>
      <option>11:00-12:00</option>
      <option>14:00-15:00</option>
      <option>15:00-16:00</option>
    </select>
    <select id="caseScanType" class="auth-input">
      <option>CT</option><option>MRI</option><option>X-Ray</option><option>Ultrasound</option>
    </select>
    <select id="casePriority" class="auth-input">
      <option>Critical</option><option>Medium</option><option>Safe</option>
    </select>
    <input id="caseRefDoc" class="auth-input" placeholder="Referring Doctor" />
    <textarea id="caseSymptoms" class="auth-input"></textarea>

    <button class="primary-btn" onclick="scheduleCase()">Schedule</button>
    <div class="success-text" id="caseSuccess">Scheduled.</div>
  </div>

  <!-- All Cases -->
  <div class="section" id="adminCases">
    <div class="section-title">All Cases</div>
    <ul id="adminCasesList" class="case-list"></ul>
  </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- DOCTOR DASHBOARD -->
<!-- ----------------------------------------------------------- -->
<div class="dashboard" id="doctorDashboard">
  <button class="logout-btn" onclick="logout()">Logout</button>
  <div class="section" style="display:block;">
    <div class="section-title">Assigned Cases</div>
    <ul id="doctorCasesList" class="case-list"></ul>
  </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- PATIENT DASHBOARD -->
<!-- ----------------------------------------------------------- -->
<div class="dashboard" id="patientDashboard">
  <button class="logout-btn" onclick="logout()">Logout</button>
  <div class="section" style="display:block;">
    <div class="section-title">My Cases</div>
    <ul id="patientCasesList" class="case-list"></ul>
  </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- TECHNICIAN DASHBOARD -->
<!-- ----------------------------------------------------------- -->
<div class="dashboard" id="techDashboard">
  <button class="logout-btn" onclick="logout()">Logout</button>
  <div class="section" style="display:block;">
    <div class="section-title">Upload Images</div>
    <ul id="techCasesList" class="case-list"></ul>
  </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- RADIOLOGIST DASHBOARD -->
<!-- ----------------------------------------------------------- -->
<div class="dashboard" id="radioDashboard">
  <button class="logout-btn" onclick="logout()">Logout</button>
  <div class="section" style="display:block;">
    <div class="section-title">Cases With Images</div>
    <ul id="radioCasesList" class="case-list"></ul>
  </div>
</div>

<!-- ----------------------------------------------------------- -->
<!-- SOCKET HANDLER (minimal) -->
<!-- ----------------------------------------------------------- -->
<script>
  const API_BASE = "https://radiology-backend-vvor.onrender.com";

  const socket = io(API_BASE, { transports: ["websocket"], withCredentials: true });

  socket.on("case-updated", () => {
    loadAdminCases?.();
    loadDoctorCases?.();
    loadPatientCases?.();
    loadRadioCases?.();
  });

  socket.on("images-updated", () => {
    loadTechCases?.();
    loadRadioCases?.();
  });
</script>

<!-- MAIN APP LOGIC -->
<script src="script.js"></script>

</body>
</html>
